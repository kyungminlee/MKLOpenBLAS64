name: Build and Test

on: [pull_request, push]

jobs:
  build:
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout
        uses: actions/checkout@v2.3.3
      - name: Install MKL
        run: sudo apt-get install -y libmkl-interface-dev libmkl-dev libclang-dev
      - name: Build
        run: |
          cp options.cmake.linux options.cmake
          cmake -B build
          cmake --build build
      - name: Pre-Generate
        run: |
          git submodule update --init
          cd data
          bash ./get_symbols.sh
      - name: Generate
        run: |
          rm mklopenblas64.c
          cmake -B generate
          cmake --build generate
          head mklopenblas64.c


          
